/*! deckster - v0.2.21 - 2015-05-17
* https://github.com/DecksterTeam/DecksterJS
* Copyright (c) 2015 Deckster Team; Licensed MIT */
!function(t){"use strict";"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)}),Object.prototype.watchit||Object.defineProperty(Object.prototype,"watchit",{enumerable:!1,configurable:!0,writable:!1,value:function(t,e){var i=this[t],s=function(){return i},n=function(s){return i===s?!1:(e.call(this,t,i,s),void(i=s))};delete this[t]&&Object.defineProperty(this,t,{get:s,set:n,enumerable:!0,configurable:!0})}}),Object.prototype.unwatchit||Object.defineProperty(Object.prototype,"unwatchit",{enumerable:!1,configurable:!0,writable:!1,value:function(t){var e=this[t];delete this[t],this[t]=e}}),t.Hashcode=function(){var t=function(t){var e,i=0;for(t=t.toString(),e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e)&4294967295;return i},e=function(e){var s=0;for(var n in e)e.hasOwnProperty(n)&&(s+=t(n+i(e[n])));return s},i=function(i){var s={string:t,number:t,"boolean":t,object:e},n=typeof i;return null!==i&&s[n]?s[n](i)+t(n):0};return{value:i}}(),t._=t._||{};var e=function(t,e){return null!=t&&hasOwnProperty.call(t,e)},i=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},s=function(t){if(!i(t))return[];if(Object.keys)return Object.keys(t);var s=[];for(var n in t)e(t,n)&&s.push(n);return s},n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},o=function(t){var e=function(e){return t[e]},i="(?:"+s(t).join("|")+")",n=new RegExp(i),o=new RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}};t._.escape=o(n)}(window),function(t,e){"function"==typeof define&&define.amd?define("deckster-card",["jquery"],e):t.DecksterCard=e(t.$||t.jQuery)}(this,function(t){"use strict";function e(i,s){if(this.$el=t(i),this.$deckster=this.$el.parents(".deckster-deck").data("deckster"),this.options=e.extendDefaults(s),this.$cardHashKey=Hashcode.value(this.options),this.currentSection="summary",this.isExpanded=!1,this.spinner=null,this.options.summaryViewType&&Deckster.views[this.options.summaryViewType]){var n=Deckster.views[this.options.summaryViewType];this.options.summaryContentHtml=n.getContentHtml||t.noop,this.options.onSummaryLoad=n.onLoad||t.noop,this.options.resizeSummaryContent=n.resize||t.noop}if(this.options.detailsViewType&&Deckster.views[this.options.detailsViewType]){var o=Deckster.views[this.options.detailsViewType];this.options.detailsContentHtml=o.getContentHtml||t.noop,this.options.onDetailsLoad=o.onLoad||t.noop,this.options.resizeDetailsContent=o.resize||t.noop}this.$el.data("deckster-card",this)}var i={id:null,cardType:!1,title:null,lazyLoad:!0,usePopoutLayout:!0,hasPopout:!1,expandable:!0,reloadable:!0,expandInPlace:!1,resizable:!0,showFooter:!0,summaryContentHtml:null,summaryContentUrl:null,summaryViewType:null,detailsContentHtml:null,detailsContentUrl:null,detailsViewType:null,leftControlsHtml:null,leftControlsContentUrl:null,rightControlsHtml:null,rightControlsContentUrl:null,centerControlsHtml:null,centerControlsContentUrl:null,getPopoutUrl:function(t){return t.options.rootUrl+"/card/"+t.options.id},popoutCard:null,position:{size_x:1,size_y:1,expanded_x:null,expanded_y:null,col:1,row:1},spinnerOpts:{lines:8,length:1,width:4,radius:6,corners:1,rotate:0,direction:1,color:"#000",speed:1,trail:60,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},onSummaryLoad:t.noop,onSummaryDisplayed:t.noop,onDetailsLoad:t.noop,onDetailsDisplayed:t.noop,onResize:t.noop,onExpand:t.noop,onCollapse:t.noop,onReload:t.noop,resizeSummaryContent:t.noop,resizeDetailsContent:t.noop,loadData:t.noop,fieldsToSerialize:["id","cardType","title","lazyLoad","usePopoutLayout","hasPopout","expandable","showFooter","position","fieldsToSerialize"]};e.getDefaults=function(){return i},e.extendDefaults=function(e){var s=e.fieldsToSerialize,n=t.extend(!0,{},i,e);return s&&(n.fieldsToSerialize=s),n},e.getCardHtml=function(t){var i=window.Deckster.Templates["card/card"];return i({card:e.extendDefaults(t)})},e.getCardHash=function(t){return Hashcode.value(e.extendDefaults(t))};var s=e.prototype;s.getCardData=function(){var e=this.$el.data("coords").grid,i={col:e.col,row:e.row};this.isExpanded?(i.expanded_x=e.size_x,i.expanded_y=e.size_y,i.size_x=this.options.position.size_x,i.size_y=this.options.position.size_y):(i.size_x=e.size_x,i.size_y=e.size_y,i.expanded_x=this.options.position.expanded_x,i.expanded_y=this.options.position.expanded_y);var s={};return t.each(this.options.fieldsToSerialize,t.proxy(function(t,e){s[e]=this.options[e]},this)),t.extend(!0,{},s,{position:i,isExpanded:this.isExpanded})},s.loadCard=function(t){return this.hidden||this.options.hidden?this.hideCard():(this.loadSummaryContent(t),this.hasDetails=!(!this.options.detailsContentHtml&&!this.options.detailsContentUrl),"undefined"==typeof Spinner||this.spinner||(this.spinner=new Spinner(this.options.spinnerOpts)),!this.options.expandable||this.options.isPopout?this.$el.find(".deckster-card-toggle").hide():this.$el.find(".deckster-card-toggle").show(),!this.options.resizable||this.options.isPopout?this.$el.find(".gs-resize-handle").hide():this.$el.find(".gs-resize-handle").show(),this.options.reloadable?this.$el.find(".deckster-card-reload").show():this.$el.find(".deckster-card-reload").hide(),!this.options.hasPopout||this.options.isPopout?this.$el.find(".deckster-card-popout").hide():this.$el.find(".deckster-card-popout").show(),!this.hasDetails||this.options.lazyLoad&&"details"!==this.currentSection||this.loadDetailsContent(t),this.bindCardHandlers(),this.setWatchers()),this},s.loadPopout=function(){return this.options.isPopout&&this.$el.html('<div class="deckster-popout-wrapper">'+e.getCardHtml(this.options)+"</div>"),this.loadCard()},s.showSpinner=function(){return this.spinner&&(this.$el.find(".deckster-card-overlay").show(),this.spinner.spin(this.$el.find(".deckster-card-content")[0])),this},s.hideSpinner=function(){return this.spinner&&(this.$el.find(".deckster-card-overlay").hide(),this.spinner.stop()),this},s.setCardContent=function(t,e,i,s){if(i&&t===this.currentSection||!i){var n=this.$el.find(".deckster-card-content .deckster-"+t);n.empty(),n.html(e),this[t+"Loaded"]=!0,"summary"===t?this.options.onSummaryLoad(this,"summary"):this.options.onDetailsLoad(this,"details"),this.options.onReload(this),this.loadLeftControls(),this.loadRightControls(),this.loadCenterControls()}return this.hideSpinner(),s&&s.call(this),this};var n=function(e,i){t.get(e,i)};return s.loadLeftControls=function(){return t.isFunction(this.options.leftControlsHtml)?this.options.leftControlsHtml(this,t.proxy(function(t){this.$el.find(".deckster-card-controls.left").empty().html(t)},this)):this.options.leftControlsHtml?this.$el.find(".deckster-card-controls.left").empty().html(this.options.leftControlsHtml):this.options.leftControlsContentUrl&&n(this.options.leftControlsContentUrl,t.proxy(function(t){this.$el.find(".deckster-card-controls.left").empty().html(t)},this)),this},s.loadRightControls=function(){return t.isFunction(this.options.rightControlsHtml)?this.options.rightControlsHtml(this,t.proxy(function(t){this.$el.find(".deckster-card-controls.right").empty().html(t)},this)):this.options.rightControlsHtml?this.$el.find(".deckster-card-controls.right").empty().html(this.options.rightControlsHtml):this.options.rightControlsContentUrl&&n(this.options.rightControlsContentUrl,t.proxy(function(t){this.$el.find(".deckster-card-controls.right").empty().html(t)},this)),this},s.loadCenterControls=function(){return t.isFunction(this.options.centerControlsHtml)?this.options.centerControlsHtml(this,t.proxy(function(t){this.$el.find(".deckster-card-controls.center").empty().html(t)},this)):this.options.centerControlsHtml?this.$el.find(".deckster-card-controls.center").empty().html(this.options.centerControlsHtml):this.options.centerControlsContentUrl&&n(this.options.centerControlsContentUrl,t.proxy(function(t){this.$el.find(".deckster-card-controls.center").empty().html(t)},this)),this},s.loadSummaryContent=function(e,i){return this.showSpinner(),t.isFunction(this.options.summaryContentHtml)?this.options.summaryContentHtml(this,t.proxy(function(t){this.setCardContent("summary",t,e,i)},this)):this.options.summaryContentHtml?this.setCardContent("summary",this.options.summaryContentHtml,e,i):this.options.summaryContentUrl?n(this.options.summaryContentUrl,t.proxy(function(t){this.setCardContent("summary",t,e,i)},this)):this.hideSpinner(),this},s.loadDetailsContent=function(e,i){return this.showSpinner(),t.isFunction(this.options.detailsContentHtml)?this.options.detailsContentHtml(this,t.proxy(function(t){this.setCardContent("details",t,e,i)},this)):this.options.detailsContentHtml?this.setCardContent("details",this.options.detailsContentHtml,e,i):this.options.detailsContentUrl?n(this.options.detailsContentUrl,t.proxy(function(t){this.setCardContent("details",t,e,i)},this)):this.hideSpinner(),this},s.loadContent=function(t,e){return"summary"===t?this.loadSummaryContent(!1,e):this.loadDetailsContent(!1,e),this},s.reloadContent=function(){return this.loadCard(!0)},s.scrollToCard=function(){return this.$deckster.$el.parents(this.$deckster.options.scrollContainer).animate({scrollTop:this.$el.offset().top},this.$deckster.options.scrollToSpeed),this},s.expandCard=function(t){var e=this,i=this.options.expandInPlace?this.$el.data("coords").grid.col:1;this.$deckster.$gridster.expand_widget(this.$el,this.options.position.expanded_x,this.options.position.expanded_y||4,i,function(){e.isExpanded=!0,e.$el.find(".deckster-card-toggle").removeClass("glyphicon-resize-full").addClass("glyphicon-resize-small"),e.options.onExpand.call(e,e),t&&t.call(e)})},s.collapseCard=function(t){var e=this;this.$deckster.$gridster.collapse_widget(this.$el,function(){e.isExpanded=!1,e.$el.find(".deckster-card-toggle").removeClass("glyphicon-resize-small").addClass("glyphicon-resize-full"),e.options.onCollapse.call(e,e),t&&t.call(e)})},s.toggleCard=function(t){this.options.expandable&&(this.isExpanded?this.collapseCard(t):this.expandCard(t))},s.changeSection=function(e,i){return this.$el.find(".deckster-"+i).fadeOut(200,t.proxy(function(){this.$el.find(".deckster-"+this.currentSection).fadeIn(200,t.proxy(function(){"summary"===this.currentSection?(this.options.onSummaryDisplayed(this),this.options.resizeSummaryContent(this,"summary")):(this.options.onDetailsDisplayed(this),this.options.resizeDetailsContent(this,"details"))},this))},this)),this},s.toggleSection=function(e){var i=this.currentSection;return this.currentSection=e?e:"summary"===this.currentSection&&this.hasDetails?"details":"summary",this.currentSection!==i?this.loadContent(this.currentSection,t.proxy(function(){this.options.expandable&&!this.options.isPopout?this.toggleCard(function(){this.changeSection(this.currentSection,i)}):this.changeSection(this.currentSection,i)},this)):this.options.expandable&&!this.options.isPopout&&this.toggleCard(t.proxy(function(){"summary"===this.currentSection?(this.options.onSummaryDisplayed(this),this.options.resizeSummaryContent(this,"summary")):(this.options.onDetailsDisplayed(this),this.options.resizeDetailsContent(this,"details"))},this)),this},s.resizeCardViews=function(){return this.options.resizeSummaryContent(this,"summary"),this.options.resizeDetailsContent(this,"details"),this},s.hideCard=function(){return this.hiddenState=this.getCardData(),this.$deckster.$gridster.remove_widget(this.$el,!1),this.hidden=!0,this},s.showCard=function(){return this.hidden&&this.hiddenState&&(this.currentSection="summary",this.$el=this.$deckster.$gridster.add_widget(e.getCardHtml(this.options),this.hiddenState.position?this.hiddenState.position.size_x:null,this.hiddenState.position?this.hiddenState.position.size_y:null,this.hiddenState.position?this.hiddenState.position.col:null,this.hiddenState.position?this.hiddenState.position.row:null,null,null,t.proxy(function(){this.$el.data("deckster-card",this),this.hiddenState=null,this.hidden=!1,this.loadCard(),this.isExpanded&&(this.isExpanded=!1,this.toggleSection("details"))},this))),this},s.popoutCard=function(){var e;this.options.popoutCard&&t.isFunction(this.options.popoutCard)?this.options.popoutCard(this):(e=this.options.getPopoutUrl(this),e&&window.open(e,"_blank"))},s.setWatchers=function(){return this.options.watchit("title",t.proxy(function(t,e,i){i&&this.$el.find(".deckster-card-title h2").html(i)},this)),this.options.watchit("expandable",t.proxy(function(t,e,i){i?this.$el.find(".deckster-card-toggle").show():this.$el.find(".deckster-card-toggle").hide()},this)),this.options.watchit("resizable",t.proxy(function(t,e,i){i?this.$el.find(".gs-resize-handle").show():this.$el.find(".gs-resize-handle").hide()},this)),this.options.watchit("hasPopout",t.proxy(function(t,e,i){i?this.$el.find(".deckster-card-popout").show():this.$el.find(".deckster-card-popout").hide()},this)),this.options.watchit("reloadable",t.proxy(function(t,e,i){i?this.$el.find(".deckster-card-reload").show():this.$el.find(".deckster-card-reload").hide()},this)),this},s.removeWatchers=function(){return this.options.unwatchit("title"),this.options.unwatchit("expandable"),this.options.unwatchit("resizable"),this.options.unwatchit("hasPopout"),this.options.unwatchit("reloadable"),this},s.bindCardHandlers=function(){return this.$el.off("click.deckster-card",".deckster-card-toggle"),this.$el.on("click.deckster-card",".deckster-card-toggle",t.proxy(function(){this.toggleSection()},this)),this.$el.off("click.deckster-card",".deckster-card-reload"),this.$el.on("click.deckster-card",".deckster-card-reload",t.proxy(function(){this.reloadContent()},this)),this.$el.off("click.deckster-card",".deckster-card-remove"),this.$el.on("click.deckster-card",".deckster-card-remove",t.proxy(function(){this.destroy()},this)),this.$el.off("click.deckster-card",".deckster-card-popout"),this.$el.on("click.deckster-card",".deckster-card-popout",t.proxy(function(){this.popoutCard()},this)),this},s.destroy=function(){this.$el.off("click.deckster-card",".deckster-card-toggle"),this.$el.off("click.deckster-card",".deckster-card-reload"),this.$el.off("click.deckster-card",".deckster-card-remove"),this.$el.off("click.decgrukster-card",".deckster-card-popout"),this.removeWatchers(),this.$deckster.removeCard(this)},e}),function(t,e){"function"==typeof define&&define.amd?define(["jquery","deckster-card","gridster"],e):t.Deckster=e(t.$||t.jQuery,t.DecksterCard,t.Gridster)}(this,function(t,e,i){"use strict";function s(e,i){this.$wrapper=t(e),this.$el=this.$wrapper.addClass("deckster-deck").append(window.Deckster.Templates["deck/deck"]()).find(".deck"),this.$cardHash={},this.$gridster=null,this.options=t.extend(!0,{},n,i),this.options.gridsterOpts.resize.stop||(this.options.gridsterOpts.resize.stop=this.widget_resized),this.options.autoInit&&this.init()}var n={rootUrl:"/deckster",autoInit:!0,scrollToSpeed:1e3,scrollContainer:".deckster-deck",gridsterOpts:{columns:5,margins:[10,10],rowHeight:150,draggable:{handle:".drag-handle"},resize:{enabled:!0}},onRemoveCard:t.noop};s.cards=s.cards||{},s.views=s.views||{},s.getRoutes=function(t,e){return t=t?t:"deckster/",t=t&&t.endsWith("/")?t:t+"/",e=e?e:"?",[{basePath:t+"card",fullPath:t+"card/:id/:section"+e,queryParams:[{name:"id",optional:!1},{name:"section",optional:!0}]}]},s.getPopoutRoute=function(t,e){return t=t?t:"deckster/",t=t&&t.endsWith("/")?t:t+"/",e=e?e:"?",{basePath:t+"card",fullPath:t+"card/:id/:section"+e,queryParams:[{name:"id",optional:!1},{name:"section",optional:!0}]}},s.generatePopout=function(t,i,s){return i.isPopout=!0,s=s||"details",new e(t,i).loadPopout().toggleSection(s)};var o=s.prototype;return o.serializeDeck=function(){var t=this.options;t.cards=[];for(var e in this.$cardHash)this.$cardHash.hasOwnProperty(e)&&t.cards.push(this.$cardHash[e].getCardData());return t},o.widget_resized=function(t,e,i){var s=i.data("deckster-card");return s.options.onResize&&s.options.onResize.call(s,s),this},o.init=function(t){this.$gridster=new i(this.$el,this.options.gridsterOpts),t&&this.addCards(t)},o.hasCard=function(t){var i=e.getCardHash(t);return this.$cardHash.hasOwnProperty(i)},o.getCards=function(){return t.map(this.$cardHash,function(t){return t})},o.addCards=function(e){return t.each(e,t.proxy(function(t,e){this.addCard(e)},this)),this},o.addCard=function(i,n){if(i.rootUrl=i.rootUrl||this.options.rootUrl,i.cardType&&s.cards[i.cardType]&&(i=t.extend(!0,{},s.cards[i.cardType],i)),this.hasCard(i))return null;this.$cardHash[e.getCardHash(i)]=i;var o=this.$gridster.add_widget(e.getCardHtml(i),i.position?i.position.size_x:null,i.position?i.position.size_y:null,i.position?i.position.col:null,i.position?i.position.row:null,null,null,t.proxy(function(){var t=new e(o,i).loadCard();this.$cardHash[t.$cardHashKey]=t,n&&n(t)},this));return this},o.clearDeck=function(){return t.each(this.$cardHash,t.proxy(function(t,e){this.removeCard(e)},this)),this},o.removeCard=function(t){return this.$gridster.remove_widget(t.$el),delete this.$cardHash[t.$cardHashKey],this.options.onRemoveCard.call(this,t),this},o.destroy=function(){this.$wrapper.removeData("deckster"),this.$gridster.destroy()},t.fn.deckster=function(e){return this.each(function(){t.data(this,"deckster")||t.data(this,"deckster",new s(this,e))})},s}),function(){window.Deckster=window.Deckster||{},window.Deckster.Templates=window.Deckster.Templates||{},window.Deckster.Templates["card/card"]=function(obj){obj||(obj={});{var __t,__p="";_.escape,Array.prototype.join}with(obj)__p+=card.isPopout?'\n<div class="deckster-card is-popout" id="'+(null==(__t=card.id)?"":__t)+'">\n':'\n<div class="deckster-card" id="'+(null==(__t=card.id)?"":__t)+'">\n',__p+='\n    <div class="deckster-card-inner">\n        <div class="deckster-card-header">\n            <div class="deckster-card-controls left"></div>\n            <div class="deckster-card-title drag-handle">\n              <h2 class="drag-handle">'+(null==(__t=card.title)?"":__t)+'</h2>\n              <span class="deckster-card-controls center"></span>\n            </div>\n            <div class="deckster-default-controls">\n              <span class="deckster-card-control deckster-card-reload glyphicon glyphicon-refresh"></span>\n              <span class="deckster-card-control deckster-card-toggle glyphicon glyphicon-resize-full"></span>\n              <span class="deckster-card-control deckster-card-popout glyphicon glyphicon-new-window thin"></span>\n            </div>\n            <div class="deckster-card-controls right"></div>\n        </div>\n        <div class="deckster-card-content">\n            <div class="deckster-card-overlay"></div>\n            <div class="deckster-summary"></div>\n            <div class="deckster-details" style="display: none;"></div>\n        </div>\n        ',card.showFooter&&(__p+='\n        <div class="deckster-card-footer">\n          <div class="left-controls"></div>\n          <div class="right-controls">\n            <span class="deckster-card-control deckster-card-remove glyphicon glyphicon-trash"></span>\n          </div>\n        </div>\n        '),__p+="\n    </div>\n</div>\n";return __p}}(),function(){window.Deckster=window.Deckster||{},window.Deckster.Templates=window.Deckster.Templates||{},window.Deckster.Templates["deck/deck"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="deck gridster"></div>\n';return __p}}(),function(){window.Deckster=window.Deckster||{},window.Deckster.Templates=window.Deckster.Templates||{},window.Deckster.Templates["deck/dock"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="deckster-deck-dock">\n</div>';return __p}}(),function(){window.Deckster=window.Deckster||{},window.Deckster.Templates=window.Deckster.Templates||{},window.Deckster.Templates["deck/toolbar"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='<div class="deckster-deck-toolbar">\n    <img class="deck-toolbar-logo" src="'+(null==(__t=deck.logoUrl)?"":__t)+'"/>\n    <div class="deck-search-wrapper">\n        <input type="text" class="deck-toolbar-searchbox" placeholder="'+(null==(__t=deck.searchPlaceholder)?"":__t)+'">\n    </div>\n    <div class="deck-toolbar-controls">\n        <span class="toolbar-control refresh glyphicon glyphicon-refresh"></span>\n        <span class="toolbar-control settings glyphicon glyphicon-cog"></span>\n        <span class="toolbar-control save glyphicon glyphicon-floppy-disk"></span>\n    </div>\n</div>';return __p}}();